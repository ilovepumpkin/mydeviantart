<import src="../../components/searchBar/searchBar"/>

<view class="mask" hidden="{{!isEdit}}">
</view>
<view class="editArea" hidden="{{!isEdit}}">
    <view class="editUser" >
        <input class="inputField" value="{{username}}" bindinput="onUsernameInput"/>
    </view>
    <view class="saveButton">
        <view style="width:150px" class="saveButton">
        <button class="btn,btn-secondary" size="mini" bindtap="cancelChangeUser">取消</button>
        <button class="btn" type="primary" size="mini" bindtap="saveUser" disabled="{{!username||username.trim().length===0}}">保存</button>
        </view>
    </view>
</view>
<!-- <view class="add" bindtap="startEdit" hidden="{{isEdit}}">
    <image src="/images/add.png" class="addIcon"/>  
</view> -->



<template is="searchBar" data="{{search,authorPhotoUrl:currentUser['usericon']}}" />
<movable-area class="movableArea" style="z-index:500;height:{{scrollViewHeight}}px;width:100%;" >
    <movable-view class="add" bindtap="startEdit" hidden="{{isEdit}}" direction="all" x="{{addIconX}}" y="{{addIconY}}">
        <image src="/images/add.png" class="addIcon"/>
    </movable-view>

<view >
    <scroll-view scroll-x="true" class="tab-h" scroll-left="{{scrollLeft}}">
        <block wx:for="{{groups}}">
            <view class="tab-item {{currentTab==item.name?'active':''}}"  data-current="{{item.name}}" bindtap="switchNav">{{item.name}}</view>
        </block>
    </scroll-view>
    <scroll-view hidden="{{currentTab==='[新建]'}}" scroll-y="true" style="height:{{scrollViewHeight-40}}px;width:100%;" class="scrollView">
        <view class="{{item.username==currentUser['username']?'current':'notCurrent'}} authorLine"  wx:key="{{item.username}}" wx:for="{{authors}}" data-username="{{item.username}}" >
            <view class="author" style="{{item.txtStyle}}" bindtouchstart="touchS" bindtouchmove="touchM" bindtouchend="touchE"  data-index="{{index}}" data-username="{{item.username}}" bindtap="onTouchTap">
                    <image src="{{item.usericon}}" class="photo"/>
                    <view class="info">
                        <view class="realName">{{item.real_name}}</view>
                        <view class="userName">{{item.username}}</view>
                    </view>
            </view> 
            <view class="viewDetail" data-username="{{item.username}}" bindtap="gotoAuthorDetail" data-index="{{index}}">
                    查看
            </view>
            <view class="delete" data-username="{{item.username}}" bindtap="onDeleteAuthor" data-index="{{index}}">
                    删除
            </view>
        </view>
    </scroll-view>
    <view hidden="{{currentTab!=='[新建]'}}" style="height:{{scrollViewHeight-40}}px;width:100%;" class="scrollView newgroup">
        <view class="editUser" >
            <input class="inputField" value="{{groupName}}" bindinput="onGroupnameInput"/>
        </view>
        <view class="saveButton">
            <view style="width:150px" class="saveButton">
                <button class="btn,btn-secondary" size="mini" bindtap="cancelCreateGroup">取消</button>
                <button class="btn" type="primary" size="mini" bindtap="createGroup" disabled="{{!groupName||groupName.trim().length===0}}">创建</button>
            </view>
        </view>
    </view>
    <view hidden="{{authors.length!==0}}" style="height:{{scrollViewHeight-40}}px;width:100%;" class="scrollView newgroup">
        <view class="saveButton">
            <view style="width:150px" class="saveButton">
                <button class="btn" type="warn" size="mini" bindtap="deleteGroup">删除</button>
            </view>
        </view>
    </view>
</view>


</movable-area>
<loading hidden="{{!isLoading}}">加载中...</loading>



              
